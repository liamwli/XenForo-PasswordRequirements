<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="liam_passwordRequirements" title="Password Requirements" version_string="1.1.1" version_id="10101" url="https://xf-liam.com/" install_callback_class="LiamW_PasswordRequirements_Installer" install_callback_method="install" uninstall_callback_class="LiamW_PasswordRequirements_Installer" uninstall_callback_method="uninstall">
  <admin_navigation>
    <navigation navigation_id="liam_forcePasswordChange" parent_navigation_id="usersSection" display_order="10000" link="users/force-password-change" admin_permission_id="user" debug_only="0" hide_no_children="0"/>
  </admin_navigation>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates>
    <template title="liam_passwordRequirements_force_confirm"><![CDATA[<xen:title>{xen:phrase liam_passwordRequirements_force_reset}</xen:title>

<xen:if is="{$user}">
	<xen:navigation>
		<xen:breadcrumb href="{xen:adminlink 'users/edit', $user}">{$user.username}</xen:breadcrumb>
	</xen:navigation>
</xen:if>

<xen:require css="public:delete_confirmation.css" />

<xen:form action="{xen:adminlink users/force-password-change}" class="deleteConfirmForm formOverlay">
	<xen:if is="{$user}">
		<p>{xen:phrase liam_passwordRequirements_force_reset_user, 'username={$user.username}'}</p>
		<input type="hidden" name="user_id" value="{$user.user_id}" />
	<xen:else />
		<p>{xen:phrase liam_passwordRequirements_force_reset_all_users}</p>
	</xen:if>

	<xen:submitunit save="{xen:phrase liam_passwordRequirements_force_reset}" />
	
	<input type="hidden" name="_xfConfirm" value="1" />
</xen:form>]]></template>
    <template title="liam_passwordRequirements_option_passwordCriteria"><![CDATA[<xen:controlunit label="{$preparedOption.title}" hint="{$preparedOption.hint}">
	<xen:explain>{xen:raw $preparedOption.explain}</xen:explain>
	<xen:html>
		<ul>
			<li>
				{xen:phrase liam_passwordRequirements_max_age}:
				<xen:spinbox name="{$fieldPrefix}[{$preparedOption.option_id}][max_age]" min="0" value="{$preparedOption.option_value.max_age}" />
			</li>
	
			<li>
				{xen:phrase liam_passwordRequirements_min_age}:
				<xen:spinbox name="{$fieldPrefix}[{$preparedOption.option_id}][min_age]" min="0" value="{$preparedOption.option_value.min_age}" />
			</li>
			
			<li>
				{xen:phrase liam_passwordRequirements_remember_x_passwords}:
				<xen:spinbox name="{$fieldPrefix}[{$preparedOption.option_id}][password_history]" min="0" value="{$preparedOption.option_value.password_history}" />
			</li>
			
			<li>
				{xen:phrase liam_passwordRequirements_min_length}:
				<xen:spinbox name="{$fieldPrefix}[{$preparedOption.option_id}][min_length]" min="0" value="{$preparedOption.option_value.min_length}" />
			</li>
	
			<li>
				{xen:phrase liam_passwordRequirements_max_length}:
				<xen:spinbox name="{$fieldPrefix}[{$preparedOption.option_id}][max_length]" min="0" value="{$preparedOption.option_value.max_length}" />
			</li>
	
			<li>
				{xen:phrase liam_passwordRequirements_regex}:
				<xen:textbox name="{$fieldPrefix}[{$preparedOption.option_id}][regex]" value="{$preparedOption.option_value.regex}" size="20" />
			</li>
						
			<xen:checkbox>
				<xen:option label="{xen:phrase liam_passwordRequirements_complex}" name="{$fieldPrefix}[{$preparedOption.option_id}][complex]" selected="{$preparedOption.option_value.complex}" />
			</xen:checkbox>
		</ul>
		
		<input type="hidden" name="{$listedFieldName}" value="{$preparedOption.option_id}" />
		{xen:raw $editLink}
	</xen:html>
</xen:controlunit>]]></template>
  </admin_templates>
  <admin_template_modifications>
    <modification template="user_edit" modification_key="liam_passwordRestrictions_user_edit" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<li><a href="{xen:adminlink users/manage-watched-threads, $user}" class="OverlayTrigger">{xen:phrase manage_watched_threads}</a></li>]]></find>
      <replace><![CDATA[$0
<li><a href="{xen:adminlink users/force-password-change, $user}" class="OverlayTrigger">{xen:phrase liam_passwordRequirements_force_reset}</a></li>]]></replace>
    </modification>
  </admin_template_modifications>
  <code_events/>
  <code_event_listeners>
    <listener event_id="controller_post_dispatch" execute_order="10" callback_class="LiamW_PasswordRequirements_Listener" callback_method="controllerPostDispatch" active="1" hint="XenForo_ControllerPublic_Account" description=""/>
    <listener event_id="controller_pre_dispatch" execute_order="10" callback_class="LiamW_PasswordRequirements_Listener" callback_method="controllerPreDispatch" active="1" hint="" description=""/>
    <listener event_id="file_health_check" execute_order="10" callback_class="LiamW_PasswordRequirements_FileSums" callback_method="addHashes" active="1" hint="" description=""/>
    <listener event_id="load_class_controller" execute_order="10" callback_class="LiamW_PasswordRequirements_Listener" callback_method="extendUserController" active="1" hint="XenForo_ControllerAdmin_User" description="XenForo_ControllerAdmin_User"/>
    <listener event_id="load_class_datawriter" execute_order="10" callback_class="LiamW_PasswordRequirements_Listener" callback_method="extendUserDataWriter" active="1" hint="XenForo_DataWriter_User" description="XenForo_DataWriter_User"/>
  </code_event_listeners>
  <cron>
    <entry entry_id="liam_pr_clean" cron_class="LiamW_PasswordRequirements_Cron_CleanUp" cron_method="run" active="1"><![CDATA[{"day_type":"dow","dow":["-1"],"hours":["0"],"minutes":["0"]}]]></entry>
  </cron>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups>
    <option option_id="liam_passwordCriteria" edit_format="template" data_type="array" can_backup="1">
      <default_value></default_value>
      <edit_format_params>liam_passwordRequirements_option_passwordCriteria</edit_format_params>
      <sub_options>max_age
min_age
password_history
min_length
max_length
regex
complex</sub_options>
      <relation group_id="users" display_order="810"/>
    </option>
  </optiongroups>
  <permissions>
    <permission_groups/>
    <permissions/>
    <interface_groups/>
  </permissions>
  <phrases>
    <phrase title="admin_navigation_liam_forcePasswordChange" version_id="10000" version_string="1.0.0"><![CDATA[Force Password Change]]></phrase>
    <phrase title="cron_entry_liam_pr_clean" version_id="10000" version_string="1.0.0"><![CDATA[Password Requirements Clean Up]]></phrase>
    <phrase title="liam_passwordRequirements_complex" version_id="10000" version_string="1.0.0"><![CDATA[Apply Windows complexity rules]]></phrase>
    <phrase title="liam_passwordRequirements_force_reset" version_id="10000" version_string="1.0.0"><![CDATA[Force Password Change]]></phrase>
    <phrase title="liam_passwordRequirements_force_reset_all_users" version_id="10000" version_string="1.0.0"><![CDATA[Are you sure you wish to force all users to reset their passwords?]]></phrase>
    <phrase title="liam_passwordRequirements_force_reset_user" version_id="10000" version_string="1.0.0"><![CDATA[Are you sure you want force {username} to change their password?]]></phrase>
    <phrase title="liam_passwordRequirements_max_age" version_id="10000" version_string="1.0.0"><![CDATA[Maximum Password Age]]></phrase>
    <phrase title="liam_passwordRequirements_max_length" version_id="10000" version_string="1.0.0"><![CDATA[Maximum Password Length]]></phrase>
    <phrase title="liam_passwordRequirements_min_age" version_id="10000" version_string="1.0.0"><![CDATA[Minimum Password Age]]></phrase>
    <phrase title="liam_passwordRequirements_min_length" version_id="10000" version_string="1.0.0"><![CDATA[Minimum Password Length]]></phrase>
    <phrase title="liam_passwordRequirements_must_be_at_least_x_characters" version_id="10000" version_string="1.0.0"><![CDATA[Your password must be at least {count} characters long.]]></phrase>
    <phrase title="liam_passwordRequirements_must_be_correct_format" version_id="10000" version_string="1.0.0"><![CDATA[Your password must be in the correct format. Please contact the site admin for more information.]]></phrase>
    <phrase title="liam_passwordRequirements_must_be_less_than_x_characters" version_id="10000" version_string="1.0.0"><![CDATA[Your password must be less than or equal to {count} characters in length!]]></phrase>
    <phrase title="liam_passwordRequirements_must_wait_x_days_to_change_password" version_id="10000" version_string="1.0.0"><![CDATA[You must wait approximately {remaining} more days before you can change your password again!]]></phrase>
    <phrase title="liam_passwordRequirements_not_meet_complexity_requirements" version_id="10000" version_string="1.0.0"><![CDATA[Your password does not meet the complexity requirements:

<ul>
<li>Contain 8 characters</li>
<li>Contain a capital letter</li>
<li>Contain at least one number</li>
<li>Not contain your username</li>
</ul>]]></phrase>
    <phrase title="liam_passwordRequirements_password_expired_must_be_changed" version_id="10000" version_string="1.0.0"><![CDATA[Your password has expired and must be changed!]]></phrase>
    <phrase title="liam_passwordRequirements_password_must_be_changed" version_id="10000" version_string="1.0.0"><![CDATA[Your password must be changed. Please change your password to continue.]]></phrase>
    <phrase title="liam_passwordRequirements_regex" version_id="10000" version_string="1.0.0"><![CDATA[Password Regex Match]]></phrase>
    <phrase title="liam_passwordRequirements_remember_x_passwords" version_id="10000" version_string="1.0.0"><![CDATA[Remember x Passwords]]></phrase>
    <phrase title="liam_passwordRequirements_this_password_has_been_used_before" version_id="10000" version_string="1.0.0"><![CDATA[You have used the requested password before. For security reasons, you should use a password you have not used previously.]]></phrase>
    <phrase title="liam_passwordRequirements_you_cannot_set_your_new_password_same_as_old" version_id="10000" version_string="1.0.0"><![CDATA[You cannot change your password to your existing password!]]></phrase>
    <phrase title="option_liam_passwordCriteria" version_id="10000" version_string="1.0.0"><![CDATA[Password Criteria]]></phrase>
    <phrase title="option_liam_passwordCriteria_explain" version_id="10000" version_string="1.0.0"><![CDATA[]]></phrase>
  </phrases>
  <route_prefixes/>
  <style_properties/>
  <templates/>
  <public_template_modifications>
    <modification template="account_security" modification_key="liam_passwordRequirements_account_security" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$hasPassword}">]]></find>
      <replace><![CDATA[<xen:if is="{$forceText}">
	<div class="importantMessage">
		{xen:raw $forceText}
	</div>
</xen:if>

$0]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
